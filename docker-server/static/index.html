<!DOCTYPE html>
<html>
  <style>
    table, td, th {
      border: 1px solid #ddd;
      text-align: center;
    }

    table {
      border-collapse: collapse;
      width: 100%;
    }

    th, td {
      padding: 15px;
    }
	
    .clsInfoButtons
    {
	  display: inline-block;
	    display: grid;
		gap: 10px;
		font-size: 14px;
		cursor: pointer;
		text-align: center;
		text-decoration: none;
		color: #fff;
		background-color: #4CAF50;
		border: none;
		border-radius: 6px;
		box-shadow: 0 3px #999;
		margin: 6px;
		padding: 2px 5px 2px 5px;
    }
	
	.clsInfoButtons:hover 
	{
	  background-color: #3e8e41
	 }
	 
	.clsInfoButtons:active {
		background-color: #3e8e41;
		box-shadow: 0 5px #666;
		transform: translateY(4px);
	}
	
	.clsRestartButton
    {
		font-size: 14px;
		cursor: pointer;
		text-align: center;
		text-decoration: none;
		color: #fff;
		background-color: #da492a;
		border: none;
		border-radius: 6px;
		box-shadow: 0 3px #999;
		margin: 8px;
		padding: 2px 5px 2px 5px;
		width: 80px;
    }
	
	.clsRestartButton:hover 
	{
	  background-color: #da322a
	 }
	 
	.clsRestartButton:active {
		background-color: #da492a;
		box-shadow: 0 5px #666;
		transform: translateY(4px);
	}
	
	#loading {
		position: fixed;
		display: block;
		width: 100%;
		height: 100%;
		top: 0;
		left: 0;
		text-align: center;
		opacity: 0.7;
		background-color: #fff;
		z-index: 99;
	}

	#loading-image {
		position: center;
	}
	
    .hidden {
      display: none;
    }
	
	//========================================//
	//===============MODAL STYLING============//
	.modal {
		display: none; /* Hidden by default */
		position: fixed; /* Stay in place */
		z-index: 1; /* Sit on top */
		padding-top: 100px; /* Location of the box */
		left: 0;
		top: 0;
		width: 100%; /* Full width */
		height: 100%; /* Full height */
		overflow: auto; /* Enable scroll if needed */
		background-color: rgb(0,0,0); /* Fallback color */
		background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
	}
	
	.modal-content {
		background-color: #fefefe;
		margin: auto;
		padding: 20px;
		border: 1px solid #888;
		width: 30%;
	}

	.close {
		color: #aaaaaa;
		float: right;
		font-size: 28px;
		font-weight: bold;
	}
	
	.close:hover,
		.close:focus {
		color: #000;
		text-decoration: none;
		cursor: pointer;
	}
	//===============MODAL STYLING============//
	//=========================================//
  </style>
	<head>
		<meta charset="UTF-8">
		<title>Containers Info</title>
    <link rel="stylesheet" href="/assets/styles.css" />
	</head>
	<body>
		<div id="loading">
			<img id="loading-image" src="https://www.icegif.com/wp-content/uploads/loading-icegif-1.gif" alt="Loading..." />
		</div>
		<div id="infoModal" class="modal">
			<div class="modal-content">
				<span class="close">&times;</span>
				<pre>
					<div class="modal-body"></div>
				</pre>
			</div>
		</div>

		</div>
			<table>
				<caption>iOS Containers</caption>
				<tr>
					<th>ContainerID</th>
					<th>Image Name</th>
					<th>Container Status</th>
					<th>Container Ports</th>
					<th>Container Name</th>
					<th>Additional info</th>
					<th>Actions</th>
			</tr>
			{{range .}}
			<tr>
				<td>{{.ContainerID}}</td>
				<td>{{.ImageName}}</td>
				<td>{{.ContainerStatus}}</td>
				<td>{{.ContainerPorts}}</td>
				<td>{{.ContainerName}}</td>
				<td>
					<div>
						<button class="clsInfoButtons" id="clsInfoButton" onclick="showDeviceInfo();" value={{.DeviceUDID}}>Device Info</button>
						<button class="clsInfoButtons" id="containerLogsButton" onclick="showContainerLogs();" value={{.DeviceUDID}}>Container Logs</button>
						<button class="clsInfoButtons" id="containerLogsButton" onclick="showContainerLogs();" value={{.DeviceUDID}}>Appium Logs</button>
						<button class="clsInfoButtons" id="containerLogsButton" onclick="showContainerLogs();" value={{.DeviceUDID}}>WebDriverAgent Logs</button>
						<button class="clsInfoButtons" id="containerLogsButton" onclick="showContainerLogs();" value={{.DeviceUDID}}>WDA Sync Logs</button>
					</div>
				</td>
				<td style="text-align:center;">
					<div>
						<button class="clsRestartButton" id="restartContainerButton" onclick="restartContainer();" value={{.ContainerID}}>Restart container</button>
					</div>
				</td>
			</tr>
			{{end}}
			</table>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
	  // Present modal with the devices info parsed from the config.json
      function showDeviceInfo() {
	    // Get the device UDID that is in the value of the 'Device Info' button
        var udidFromButton = document.getElementById("clsInfoButton").value
		// Get the actual 'Device Info' button
        var infoButton = document.getElementById("clsInfoButton")
		// Call the endpoint that will get the device info
		$.ajax({
		    async: false,
			dataType: "text",
			type: "GET",
			url: "/device/" + udidFromButton,
			success: function(data) {
				showInfoModal(data);
			}
		});
      }
	  
	  // Restart container when clicking on the 'Restart container' button for the row
	  function restartContainer() {
		<!-- Get the container ID that is in the value of the 'Restart container' button -->
        var containerId = document.getElementById("restartContainerButton").value
		
		<!-- Show loading indicator until response is returned -->
		$('#loading').show();
		
		<!-- Call the endpoint that will restart the selected container -->
		$.ajax({
		    async: false,
			type: "GET",
			url: "/restartContainer/" + containerId,
			success: function(data) {
				$('.targeted').html(data);
			}
		});
		
		<!-- Hide the loading after response is returned -->
		$('#loading').hide();
		
		<!-- Present an informational alert that the container restart attempt was finished and the ID -->
		alert("Finished restart attempt on container with ID: " + containerId)
		
		<!-- Reload the page to get the latest info -->
		location.reload();
      }
	  
	  <!-- Show info modal with provided text -->
	  function showInfoModal(modalText) {
		<!-- Get the modal element-->
		var modal = document.getElementById("infoModal")
		
		<!-- Get the close button -->
		var span = document.getElementsByClassName("close")[0]
		
		<!-- Set the modal text -->
		$('.modal-body').html(modalText)
		
		<!-- Display the modal blocking interaction -->
		modal.style.display = "block";
		
		<!-- Close the modal if you click on close button -->
		span.onclick = function() {
			modal.style.display = "none";
		}
		
		<!-- Close the modal if you click anywhere outside the modal -->
		window.onclick = function(event) {
			if (event.target == modal) {
				modal.style.display = "none";
			}
		}
	  }
    </script>
	<!-- Script that hides the loading indicator on page load -->
	<script>
		$(window).on('load', function () {
			$('#loading').hide();
		}) 
	</script>
	</body>
</html>
