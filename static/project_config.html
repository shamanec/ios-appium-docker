<!DOCTYPE html>
<html>
<style>
    #loading {
        visibility: hidden;
        position: fixed;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        text-align: center;
        opacity: 0.7;
        background-color: #fff;
        z-index: 99;
    }

    #loading-image {
        position: relative;
    }
</style>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="/static/css/project_config_styles.css" rel="stylesheet">
</head>

<body>
    <div id="loading">
        <img id="loading-image" src="/static/images/loader.gif">
    </div>
    <div class="modal fade" id="configuration-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true">
        <div id="modal-body" class="modal-body" style="margin-top:200px;"></div>
    </div>
    <div class="topnav">
        <link href="/static/css/top_navigation_style.css" rel="stylesheet">
        <a href="/">Home</a>
        <a class="active" href="configuration">Project configuration</a>
        <a href="iOSContainers">iOS containers</a>
        <a href="androidContainers">Android containers</a>
    </div>
    <div>
        <table id="configurationInfoTable">
            <link href="/static/css/config_table.css" rel="stylesheet">
            <tr>
                <th>Devices Host
                    <div class="tooltip">?
                        <span class="tooltiptext">The address of the host machine</span>
                    </div>
                </th>
                <th>Selenium Hub Host
                    <div class="tooltip">?
                        <span class="tooltiptext">The address of the targetted Selenium Hub. Not used if you won't
                            connect
                            to Selenium Hub.</span>
                    </div>
                </th>
                <th>Selenium Hub Port
                    <div class="tooltip">?
                        <span class="tooltiptext">The port of the targetted Selenium Hub. Not used if you won't connect
                            to
                            Selenium Hub.</span>
                    </div>
                </th>
                <th>Selenium Hub Protocol Type
                    <div class="tooltip">?
                        <span class="tooltiptext">The protocol type of the targetted Selenium Hub. Not used if you won't
                            connect to Selenium Hub.</span>
                    </div>
                </th>
                <th>WDA Bundle ID
                    <div class="tooltip">?
                        <span class="tooltiptext">The bundle ID of the targetted WDA application.</span>
                    </div>
                </th>
            </tr>
            <tr>
                <td>{{.DevicesHost}}</td>
                <td>{{.SeleniumHubHost}}</td>
                <td>{{.SeleniumHubPort}}</td>
                <td>{{.SeleniumHubProtocolType}}</td>
                <td>{{.WdaBundleID}}</td>
            </tr>
        </table>
    </div>
    <div class="config-buttons">
        <button class="config-button" id="config-button" type="button" onclick="showConfigModal()">Change project
            config</button>
        <button class="config-button" id="config-button" type="button" onclick="showDockerfileModal()">Edit
            Dockerfile</button>
        <button class="config-button" id="config-button" type="button" onclick="buildImage(this)">Build Docker
            image</button>
        <button class="config-button" id="config-button" type="button" onclick="removeImage()">Remove Docker
            image</button>
        <button class="config-button" id="config-button" type="button">Not sure yet</button>
        <button class="config-button" id="config-button" type="button">Not sure yet</button>
        <button class="config-button" id="config-button" type="button">Not sure yet</button>
        <button class="config-button" id="config-button" type="button">Not sure yet</button>
        <button class="config-button" id="config-button" type="button">Not sure yet</button>
        <button class="config-button" id="config-button" type="button">Not sure yet</button>
    </div>
    <script>
        /* Show info modal with provided text */
        function showConfigModal() {
            /* Get the modal element */
            var modal = document.getElementById("configuration-modal")

            /* Get the close button */
            var span = document.getElementsByClassName("close")[0]

            $("#modal-body").load("/static/project_config_submission_form.html");

            /* Display the modal blocking interaction */
            modal.style.display = "block";

            /* Close the modal if you click anywhere outside the modal */
            window.onclick = function (event) {
                if (event.target == modal) {
                    modal.style.display = "none";
                }
            }
        };

        function showDockerfileModal() {
            /* Get the modal element */
            var modal = document.getElementById("configuration-modal")

            /* Get the close button */
            var span = document.getElementsByClassName("close")[0]

            $("#modal-body").load("/static/edit_file_modal.html");

            /* Display the modal blocking interaction */
            modal.style.display = "block";

            /* Close the modal if you click anywhere outside the modal */
            window.onclick = function (event) {
                if (event.target == modal) {
                    modal.style.display = "none";
                }
            }
        }

        function buildImage(obj) {
            /* Show loading indicator until response is returned */
            $('#loading').css("visibility", "visible");

            /* Call the endpoint that will restart the selected container */
            var req = $.ajax({
                timeout: 120000,
                async: false,
                type: "GET",
                url: "/build-image",
                success: function (data) {
                    alert("Successfully created image tagged: test \n" + data)
                    /* Hide the loading after response is returned */
                    $('#loading').css("visibility", "hidden");
                },
                error: function(data) {
                    alert(JSON.stringify(data))
                    $('#loading').css("visibility", "hidden");
                }
            });
            // req.success(function(data) {
            //     alert("Successfully created image tagged: test \n" + data)
            //     /* Hide the loading after response is returned */
            //     $('#loading').css("visibility", "hidden");
            // });
            // req.error(function(data) {
            //     alert(data)
            //     /* Hide the loading after response is returned */
            //     $('#loading').css("visibility", "hidden");
            // });
        }

        function removeImage() {
            /* Show loading indicator until response is returned */
            $('#loading').css("visibility", "visible");

            /* Call the endpoint that will restart the selected container */
            $.ajax({
                dataType: false,
                async: true,
                type: "GET",
                url: "/remove-image",
                success: function (data) {
                    alert(data)
                },
                error: function (data) {
                    alert(JSON.stringify(data))
                }
            });

            /* Hide the loading after response is returned */
            $('#loading').css("visibility", "hidden");
        }
    </script>
</body>

</html>